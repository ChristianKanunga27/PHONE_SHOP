<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard - PhoneHub</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root {
    --accent: #FF9500;
    --surface: #fff;
    --text: #1F2937;
    --muted: #6B7280;
    --radius: 10px;
    --shadow: 0 12px 35px rgba(0,0,0,0.08);
}

body {
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    background: #f5f5f5;
}

header {
    background: var(--accent);
    color: white;
    padding: 20px;
    text-align: center;
    font-size: 22px;
    font-weight: bold;
}

.container {
    max-width: 1200px;
    margin: 20px auto;
    padding: 10px;
}

button {
    cursor: pointer;
    border: none;
    border-radius: var(--radius);
    padding: 6px 12px;
    color: white;
}

.add-btn { background: green; margin-bottom: 15px;}
.edit-btn { background: #007BFF; }
.delete-btn { background: #D14343; }

table {
    width: 100%;
    border-collapse: collapse;
    background: var(--surface);
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
}

th, td {
    padding: 12px;
    border-bottom: 1px solid #ddd;
    text-align: left;
}

th { background: var(--accent); color: white; }

form input, form textarea {
    width: 100%;
    padding: 8px;
    margin: 5px 0 10px;
    border-radius: var(--radius);
    border: 1px solid #ccc;
}

.modal {
    display: none;
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.5);
    justify-content:center;
    align-items:center;
}

.modal-content {
    background: white;
    padding:20px;
    border-radius: var(--radius);
    width: 400px;
}

.close {
    float:right;
    font-size:18px;
    cursor:pointer;
}
</style>
</head>
<body>

<header>Admin Dashboard - PhoneHub</header>

<div class="container">
    <button class="add-btn" id="addPhoneBtn"><i class="fa-solid fa-plus"></i> Add New Phone</button>

    <table id="phonesTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Price ($)</th>
                <th>Description</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<!-- Add/Edit Phone Modal -->
<div class="modal" id="phoneModal">
    <div class="modal-content">
        <span class="close" id="closeModal">&times;</span>
        <h3 id="modalTitle">Add Phone</h3>
        <form id="phoneForm">
            <input type="hidden" id="phoneId">
            <label for="phoneName">Phone Name</label>
            <input type="text" id="phoneName" required>
            
            <label for="phonePrice">Price ($)</label>
            <input type="number" id="phonePrice" required>
            
            <label for="phoneDesc">Description</label>
            <textarea id="phoneDesc" rows="3" required></textarea>
            
            <button type="submit" class="add-btn" id="saveBtn">Save</button>
        </form>
    </div>
</div>

<script>
const phonesTable = document.querySelector("#phonesTable tbody");
const phoneModal = document.getElementById("phoneModal");
const addPhoneBtn = document.getElementById("addPhoneBtn");
const closeModal = document.getElementById("closeModal");
const phoneForm = document.getElementById("phoneForm");
const modalTitle = document.getElementById("modalTitle");
const saveBtn = document.getElementById("saveBtn");

let editPhoneId = null;

// Open Add Modal
addPhoneBtn.addEventListener("click", () => {
    modalTitle.textContent = "Add Phone";
    saveBtn.textContent = "Add";
    phoneForm.reset();
    editPhoneId = null;
    phoneModal.style.display = "flex";
});

// Close Modal
closeModal.addEventListener("click", () => phoneModal.style.display = "none");

// Fetch Phones
async function fetchPhones() {
    const res = await fetch("http://localhost:3000/phones");
    const data = await res.json();
    phonesTable.innerHTML = "";

    data.forEach(phone => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${phone.id}</td>
            <td>${phone.name}</td>
            <td>${phone.price}</td>
            <td>${phone.description}</td>
            <td>
                <button class="edit-btn" onclick="editPhone(${phone.id})"><i class="fa-solid fa-pen"></i></button>
                <button class="delete-btn" onclick="deletePhone(${phone.id})"><i class="fa-solid fa-trash"></i></button>
            </td>
        `;
        phonesTable.appendChild(tr);
    });
}

// Add or Update Phone
phoneForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const phoneData = {
        name: document.getElementById("phoneName").value,
        price: document.getElementById("phonePrice").value,
        description: document.getElementById("phoneDesc").value
    };

    if(editPhoneId){
   
        await fetch(`http://localhost:3000/phones/${editPhoneId}`, {
            method: "PUT",
            headers: {"Content-Type":"application/json"},
            body: JSON.stringify(phoneData)
        });
    } else {

        await fetch("http://localhost:3000/phones", {
            method: "POST",
            headers: {"Content-Type":"application/json"},
            body: JSON.stringify(phoneData)
        });
    }

    phoneModal.style.display = "none";
    fetchPhones();
});

async function editPhone(id){
    const res = await fetch(`http://localhost:3000/phones/${id}`);
    const phone = await res.json();
    modalTitle.textContent = "Edit Phone";
    saveBtn.textContent = "Update";
    document.getElementById("phoneName").value = phone.name;
    document.getElementById("phonePrice").value = phone.price;
    document.getElementById("phoneDesc").value = phone.description;
    editPhoneId = id;
    phoneModal.style.display = "flex";
}

async function deletePhone(id){
    if(confirm("Are you sure you want to delete this phone?")){
        await fetch(`http://localhost:3000/phones/${id}`, { method: "DELETE" });
        fetchPhones();
    }
}

fetchPhones();
</script>
</body>
</html>
