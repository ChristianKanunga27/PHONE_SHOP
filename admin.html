<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PhoneHub Admin Panel</title>

<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>

/* ===== ROOT ===== */
:root{
--accent:#FF9500;
--bg:#F3F4F6;
--surface:#fff;
--radius:12px;
--shadow:0 10px 30px rgba(0,0,0,0.05);
}

*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:Segoe UI;background:var(--bg);}

/* ===== HAMBURGER ===== */
.hamburger{
display:none;
position:fixed;
top:15px;
left:15px;
font-size:26px;
background:none;
border:none;
color:var(--accent);
z-index:120;
cursor:pointer;
}

/* ===== OVERLAY ===== */
.overlay{
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,0.5);
z-index:90;
}

/* ===== DASHBOARD ===== */
.dashboard{
display:flex;
min-height:100vh;
}

/* ===== SIDEBAR ===== */
.sidebar{
width:230px;
background:#111827;
color:white;
padding:20px;
transition:0.3s;

/* IMPORTANT FOR LOGOUT BOTTOM */
display:flex;
flex-direction:column;
height:100vh;
}

.sidebar h2{margin-bottom:25px;}

.menu-top{
flex:1;
}

.sidebar button{
width:100%;
padding:12px;
border:none;
background:none;
color:white;
text-align:left;
cursor:pointer;
border-radius:8px;
margin-bottom:8px;
}

.sidebar button:hover{
background:rgba(255,255,255,0.1);
}

/* LOGOUT BUTTON */
.logout-btn{
background:#D14343;
margin-top:auto;
}

.logout-btn:hover{
background:#b73737;
}

/* ===== MAIN ===== */
.main{
flex:1;
padding:25px;
}

.card{
background:var(--surface);
border-radius:var(--radius);
box-shadow:var(--shadow);
padding:20px;
}

.table-wrapper{
overflow-x:auto;
margin-top:15px;
}

table{
width:100%;
border-collapse:collapse;
min-width:600px;
}

th,td{
padding:12px;
border-bottom:1px solid #ddd;
text-align:left;
}

th{
background:var(--accent);
color:white;
}

.phone-img{
width:60px;
height:60px;
object-fit:cover;
border-radius:8px;
}

button.action{
padding:6px 12px;
border:none;
border-radius:8px;
color:white;
cursor:pointer;
}

.edit-btn{background:#007BFF;}
.delete-btn{background:#D14343;}

.add-btn{
background:green;
margin-bottom:15px;
padding:8px 15px;
color:white;
border:none;
border-radius:8px;
cursor:pointer;
}

/* ===== MODAL ===== */
.modal{
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,0.5);
justify-content:center;
align-items:center;
z-index:200;
}

.modal-content{
background:white;
padding:20px;
border-radius:12px;
width:90%;
max-width:400px;
}

.close{
float:right;
cursor:pointer;
font-size:22px;
}

.modal input, .modal textarea{
width:100%;
padding:8px;
margin:6px 0 12px;
}

/* ===== MOBILE ===== */
@media(max-width:800px){

.hamburger{display:block;}

.sidebar{
position:fixed;
top:0;
left:-230px;
height:100%;
z-index:100;
box-shadow:5px 0 20px rgba(0,0,0,0.3);
}

.sidebar.show{left:0;}

.overlay.show{display:block;}

.main{padding:20px;}

}

</style>
</head>

<body>

<button class="hamburger" id="hamburger">☰</button>
<div class="overlay" id="overlay"></div>

<div class="dashboard">

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">

<h2>Admin Panel</h2>

<div class="menu-top">

<button onclick="showSection('phonesSection')">
<i class="fa fa-mobile"></i> Manage Phones
</button>

<button onclick="showSection('ordersSection')">
<i class="fa fa-shopping-cart"></i> Customer Orders
</button>

</div>

<button class="logout-btn" onclick="logoutAdmin()">
<i class="fa fa-sign-out-alt"></i> Logout
</button>

</div>

<!-- MAIN -->
<div class="main">

<!-- PHONES -->
<div id="phonesSection" class="card">

<h2>Manage Phones</h2>
<button class="add-btn" onclick="openAddModal()">Add Phone</button>

<div class="table-wrapper">
<table>
<thead>
<tr>
<th>ID</th>
<th>Image</th>
<th>Name</th>
<th>Price</th>
<th>Description</th>
<th>Actions</th>
</tr>
</thead>
<tbody id="phonesTable"></tbody>
</table>
</div>

</div>

<!-- ORDERS -->
<div id="ordersSection" class="card" style="display:none">

<h2>Customer Orders</h2>

<div class="table-wrapper">
<table>
<thead>
<tr>
<th>ID</th>
<th>Customer</th>
<th>Phone No</th>
<th>Phone</th>
<th>Price</th>
<th>Date</th>
</tr>
</thead>
<tbody id="ordersTable"></tbody>
</table>
</div>

</div>

</div>
</div>

<!-- MODAL -->
<div class="modal" id="phoneModal">
<div class="modal-content">

<span class="close" onclick="closeModal()">×</span>

<h3>Add Phone</h3>

<form id="phoneForm">

<input type="hidden" id="phoneId">

<label>Name</label>
<input type="text" id="phoneName" required>

<label>Price</label>
<input type="number" id="phonePrice" required>

<label>Description</label>
<textarea id="phoneDesc" required></textarea>

<label>Image</label>
<input type="file" id="phoneImage" accept="image/*">

<img id="preview" style="width:90px;margin-top:10px;display:none">

<button class="add-btn">Save</button>

</form>

</div>
</div>

<script>

/* SIDEBAR */
const hamburger=document.getElementById("hamburger");
const sidebar=document.getElementById("sidebar");
const overlay=document.getElementById("overlay");

hamburger.onclick=()=>{
sidebar.classList.add("show");
overlay.classList.add("show");
};

overlay.onclick=()=>{
sidebar.classList.remove("show");
overlay.classList.remove("show");
};

/* SWITCH SECTION */
function showSection(id){
phonesSection.style.display="none";
ordersSection.style.display="none";
document.getElementById(id).style.display="block";

sidebar.classList.remove("show");
overlay.classList.remove("show");
}

/* LOGOUT */
function logoutAdmin(){
if(confirm("Logout admin?")){
window.location.href="login.html";
}
}

/* MODAL */
const modal=document.getElementById("phoneModal");
const form=document.getElementById("phoneForm");
const preview=document.getElementById("preview");

let editId=null;

function openAddModal(){
form.reset();
preview.style.display="none";
editId=null;
modal.style.display="flex";
}

function closeModal(){
modal.style.display="none";
}

/* IMAGE PREVIEW */
phoneImage.onchange=()=>{
const file=phoneImage.files[0];
if(file){
preview.src=URL.createObjectURL(file);
preview.style.display="block";
}
};

/* FETCH PHONES */
async function fetchPhones(){

const res=await fetch("http://localhost:3000/phones");
const phones=await res.json();

phonesTable.innerHTML="";

phones.forEach(phone=>{
phonesTable.innerHTML+=`
<tr>
<td>${phone.id}</td>
<td><img src="${phone.image}" class="phone-img"></td>
<td>${phone.name}</td>
<td>${phone.price}</td>
<td>${phone.description}</td>
<td>
<button class="action edit-btn" onclick="editPhone(${phone.id})">Edit</button>
<button class="action delete-btn" onclick="deletePhone(${phone.id})">Delete</button>
</td>
</tr>`;
});
}

/* SAVE PHONE */
form.onsubmit=async(e)=>{
e.preventDefault();

const formData=new FormData();
formData.append("name",phoneName.value);
formData.append("price",phonePrice.value);
formData.append("description",phoneDesc.value);

if(phoneImage.files[0]){
formData.append("image",phoneImage.files[0]);
}

if(editId){
await fetch(`http://localhost:3000/phones/${editId}`,{
method:"PUT",
body:formData
});
}else{
await fetch("http://localhost:3000/phones",{
method:"POST",
body:formData
});
}

modal.style.display="none";
fetchPhones();
};

/* EDIT */
async function editPhone(id){

const res=await fetch(`http://localhost:3000/phones/${id}`);
const phone=await res.json();

phoneName.value=phone.name;
phonePrice.value=phone.price;
phoneDesc.value=phone.description;

preview.src=phone.image;
preview.style.display="block";

editId=id;
modal.style.display="flex";
}

/* DELETE */
async function deletePhone(id){
if(confirm("Delete phone?")){
await fetch(`http://localhost:3000/phones/${id}`,{method:"DELETE"});
fetchPhones();
}
}

/* FETCH ORDERS */
async function fetchOrders(){

const res=await fetch("http://localhost:3000/orders");
const orders=await res.json();

ordersTable.innerHTML="";

orders.forEach(order=>{
ordersTable.innerHTML+=`
<tr>
<td>${order.id}</td>
<td>${order.customer_name}</td>
<td>${order.phone_number}</td>
<td>${order.phone_name}</td>
<td>${order.price}</td>
<td>${new Date(order.order_date).toLocaleString()}</td>
</tr>`;
});
}

fetchPhones();
fetchOrders();

</script>

</body>
</html>
