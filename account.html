<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Account - PhoneHub</title>
  <style>
     
    :root {
      --accent: #FF9500;
      --bg: #F3F4F6;
      --surface: #ffffff;
      --text: #1F2937;
      --muted: #6B7280;
      --radius: 12px;
      --shadow: 0 10px 30px rgba(0,0,0,0.06);
    }
 
    * { box-sizing: border-box; }
 
    body {
      margin: 0;
      padding: 32px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .wrap { max-width: 980px; margin: 0 auto; }
 
    .card {
      background: var(--surface);
      padding: 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
 
    .row { display: flex; gap: 20px; }
    .col { flex: 1; }
 
    h1 { margin: 0 0 18px; }
    .small { color: var(--muted); font-size: 14px; }
 
    .btn {
      background: var(--accent);
      color: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 700;
    }
    .btn:focus { outline: 3px solid rgba(255,149,0,0.12); outline-offset: 2px; }
 
    .link {
      background: transparent;
      border: 2px solid #E5E7EB;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
    }
 
    .profile { display: flex; align-items: center; gap: 12px; }
    .avatar {
      width: 64px; height: 64px;
      border-radius: 12px; background: #F1F5F9;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700; color: var(--muted);
    }

    .section { margin-top: 16px; }
 
    @media (max-width: 800px) {
      .row { flex-direction: column; }
    }
  
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Your Account</h1>
      <div id="welcome" class="small">Loading...</div>

      <div class="section">
        <div class="profile">
          <div class="avatar" id="avatar">U</div>
          <div>
            <div id="displayName" style="font-weight:700">Name</div>
            <div id="displayEmail" class="small">email@example.com</div>
          </div>
        </div>

        <div style="margin-top:14px">
          <button id="logoutBtn" class="btn">Logout</button>
          <button id="goHome" class="link" style="margin-left:10px" onclick="location.href='home.html'">Go to Home</button>
        </div>
      </div>

      <div class="section">
        <h3>Orders</h3>
        <p class="small">You have no orders yet. Orders will appear here after checkout (demo).</p>
      </div>

      <div class="section">
        <h3>Account settings</h3>
        <p class="small">Change your display name below (changes saved in localStorage).</p>
        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <input id="editName" placeholder="Your name" style="padding:8px;border-radius:8px;border:1px solid #E5E7EB;flex:1">
          <button id="saveName" class="btn">Save</button>
        </div>
        <div id="saveMsg" class="small" style="margin-top:8px;color:green;display:none">Saved.</div>
      </div>

    </div>
  </div>

  <script>
    
    (function () {
      'use strict';

      function getCurrentUser() {
        try {
          return JSON.parse(localStorage.getItem('currentUser')) || null;
        } catch (err) {
          return null;
        }
      }

      function ensureLoggedIn() {
        const user = getCurrentUser();
        if (!user) {
          window.location.href = 'login.html';
          return false;
        }
        return true;
      }
 
      function renderUser(user) {
        const displayNameEl = document.getElementById('displayName');
        const displayEmailEl = document.getElementById('displayEmail');
        const avatarEl = document.getElementById('avatar');
        const welcomeEl = document.getElementById('welcome');
        const editNameEl = document.getElementById('editName');

        displayNameEl.textContent = user.name || 'User';
        displayEmailEl.textContent = user.email || '';
        avatarEl.textContent = (user.name || 'U').charAt(0).toUpperCase();
        welcomeEl.textContent = 'Welcome back, ' + (user.name || user.email) + '.';
        editNameEl.value = user.name || '';
      }

      function logout() {
        localStorage.removeItem('currentUser');
        window.location.href = 'home.html';
      }
 
      function saveDisplayName() {
        const input = document.getElementById('editName');
        const newName = input.value.trim();
        if (!newName) return;  
        const user = getCurrentUser();
        if (!user) return;

        user.name = newName;
        localStorage.setItem('currentUser', JSON.stringify(user));
 
        try {
          const users = JSON.parse(localStorage.getItem('users') || '[]');
          const index = users.findIndex(u => u.email === user.email);
          if (index > -1) {
            users[index].name = newName;
            localStorage.setItem('users', JSON.stringify(users));
          }
        } catch (err) {
          console.warn('Failed to update users list:', err);
        }
 
        document.getElementById('displayName').textContent = newName;
        const msg = document.getElementById('saveMsg');
        msg.style.display = 'block';
        setTimeout(() => { msg.style.display = 'none'; }, 2000);
      }
  
      if (ensureLoggedIn()) {
        const user = getCurrentUser();
        renderUser(user);

        document.getElementById('logoutBtn').addEventListener('click', logout);
        document.getElementById('saveName').addEventListener('click', saveDisplayName);
      }

    })();
  </script>
</body>
</html>